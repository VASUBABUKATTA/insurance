package com.insurance.service;

import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.insurance.model.CustomerSignupDetails;
import com.insurance.repository.CustomerSignupDetailsRepository;

@Service
public class CustomerSignupService 
{
	
	@Autowired
	CustomerSignupDetailsRepository customerSignupRepository;
	
	public List<CustomerSignupDetails> getAllCustomers()
	{
		return customerSignupRepository.findAll();
	}
	public List<CustomerSignupDetails> getCustomerById(String customerId) {
        return customerSignupRepository.findByCustomerId(customerId);
    }
	
	public CustomerSignupDetails createCustomer(CustomerSignupDetails customer)
	{
		
		LocalDateTime date = LocalDateTime.now();
        DateTimeFormatter formattedDate = DateTimeFormatter.ofPattern("yyyyMMddHHmmss");
        String formattedDateString = date.format(formattedDate);
        // String otp = formattedDateString.substring(formattedDateString.length() - 4);
        customer.setCustomerId(formattedDateString);
        
        
		return customerSignupRepository.save(customer);
	}
	
	 public List<CustomerSignupDetails> getCustomerIdByMobileNo(String mobileno) 
	 {
		 return customerSignupRepository.findByMobileno(mobileno);
	 }

}
